# 화면 명세

## 1️⃣ 헤더

### 로그인 상태

- **버튼 구성**
    - 로그아웃 버튼 → `로그아웃 API`
    - 주문내역 버튼 → `주문내역 화면` 이동

### 비로그인 상태

- **버튼 구성**
    - 로그인 버튼 → `로그인 팝업` 호출
    - 회원가입 버튼 → `회원가입 팝업` 호출

---

## 2️⃣ 로그인 팝업

- **입력 항목**
    - 아이디
    - 비밀번호
- **동작**
    - 로그인 버튼 클릭 → `로그인 API` 호출

---

## 3️⃣ 회원가입 팝업

- **입력 항목**
    - 아이디
    - 이름
    - 이메일
    - 휴대폰 번호
    - 비밀번호
- **동작**
    - 회원가입 버튼 클릭 → `회원가입 API` 호출

---

## 4️⃣ 메인

- **기능 요약**
    - 상품 리스트 노출 (`상품 목록 조회 API`)
    - 상품 이미지는 DB 미저장 → 임의 이미지 노출
    - 체크박스로 상품 선택 후 장바구니 담기 가능
- **버튼 동작**
    - 상품 등록 버튼 → `상품 등록 팝업` 호출
        
        → 등록 완료 시 **메인 상품 리스트 재조회**
        
    - 장바구니 담기 버튼 → `장바구니 등록 API`

---

## 5️⃣ 상품 등록 팝업

- **입력 항목**
    - 상품명 (필수)
    - 판매가 (필수)
- **동작**
    - 등록 버튼 클릭 → `상품 등록 API`

---

## 6️⃣ 장바구니 화면

- **데이터**
    - 장바구니 상품 목록 (`장바구니 조회 API`)
- **버튼 구성**
    - 주문하기 버튼 → `주문서 화면` 이동
    - 삭제 버튼 → 체크 상품 삭제(`장바구니 삭제 API`) 후 **재조회**

---

## 7️⃣ 주문서

> 회원만 진입 가능
> 
- **데이터 조회**
    - `주문서 조회 API`
    - 회원 정보 + 장바구니 상품 정보

### 🧩 화면 구성

### 상품 영역

- 주문할 상품 목록 노출

### 주문자 입력 영역

- 이름 / 휴대폰 번호 / 이메일 (필수)
- 로그인 회원 정보 자동 세팅

### 결제 영역

- 적립금 잔액 노출
- 결제 수단: 카드 / 적립금 (복합 결제 가능)
- **결제 금액 계산**
    
    ```
    결제 금액 - 사용 적립금 = 카드 결제 금액
    
    ```
    
- 총 결제 금액 및 약관 동의 체크박스 노출

### 주문하기 버튼

- 클릭 시 **주문하기 프로세스 실행**

---

### ⚙️ 주문하기 프로세스

| 케이스 | 설명 |
| --- | --- |
| **CASE 1** | 적립금 전액 결제 → `주문 생성 API` 호출 |
| **CASE 2** | 카드 결제 금액 존재 → `주문번호 채번 API`로 시퀀스 생성 후 `sessionStorage` 저장 → 랜덤(50:50)으로 **이니시스 / 토스** 중 하나 선택하여 PG 인증창 호출 |

---

### 💳 PG 인증 프로세스

### ▪ 이니시스

1. 인증 성공 시 `returnUrl`로 이동
2. `returnUrl`은 `/server` 하위의 API URL로 설정
3. `route Handlers`에서 인증 결과 수신
4. QueryString 생성 후 결제 중 화면으로 redirect
5. 결제 중 화면에서 QueryString parsing → `sessionStorage` 주문 데이터 + 인증 응답값으로 `주문 생성 API` 호출

### ▪ 토스

1. 인증 성공 시 `successUrl`로 이동
2. QueryString으로 인증 응답 데이터 전달
3. 결제 중 화면에서 인증 응답 parsing
4. `sessionStorage` 주문 데이터 + 인증 응답값으로 `주문 생성 API` 호출

---

## 8️⃣ 결제 중 화면

- PG 인증 결과 수신
- `주문 생성 API` 호출

---

## 9️⃣ 주문 실패 화면

- 주문 생성 실패 시 노출

---

## 🔟 주문 완료 화면

- 주문 생성 성공 시 (`주문 완료 조회 API`)
- **화면 구성**
    - 주문 상세 버튼 → `주문 상세 페이지` 이동
    - 주문 내역 버튼 → `주문 내역 페이지` 이동

---

## 1️⃣1️⃣ 주문 내역

> 로그인 회원 전용 화면
> 

### 화면 구성

- **주문 내역 목록** (`주문 내역 조회 API`)
    - 주문 단위로 묶인 목록
    - 각 주문 내 상품 목록 노출
    - 각 상품마다 **주문 취소 버튼** 노출

### 동작 정의

- **주문 취소 클릭**
    
    → 취소 수량 선택 UI 노출
    
    → 선택 후 취소 버튼 클릭
    
    → `결제 취소 API` 호출
    
- **주문 번호 클릭**
    
    → 주문 상세 페이지 이동
    

---

## 1️⃣2️⃣ 주문 상세

- **선택된 주문의 상세 정보 조회 (`주문 상세 조회 API`)**

### 화면 구성

- 주문 상품 목록
- 각 상품에 **주문 취소 버튼** 노출

### 동작 정의

- **주문 취소 클릭**
    
    → 취소 수량 선택 UI 노출
    
    → 선택 후 주문 취소 버튼 클릭
    
    → `결제 취소 API` 호출
    

[초안(직접 작성)](%EC%B4%88%EC%95%88(%EC%A7%81%EC%A0%91%20%EC%9E%91%EC%84%B1)%2029b16f3a82b48037a50ce232862188c5.md)